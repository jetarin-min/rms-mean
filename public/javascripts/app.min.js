angular.module("myApp",["ngCookies","ngRoute","appUser","appNote","appProduct"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{resolve:{check:function($cookies,$location){$cookies.get("user_id")?$location.path("/product"):window.location.href="/login"}}}).when("/logout",{resolve:{check:function($cookies,$location){$cookies.get("token")&&alert("You have been Logout"),$cookies.remove("username"),$cookies.remove("userid"),$cookies.remove("token"),window.location.href="/login"}}})}]).factory("socket",["$rootScope",function($rootScope){var socket=io.connect("http://188.166.249.56:3009");return{on:function(eventName,callback){socket.on(eventName,callback)},emit:function(eventName,data){socket.emit(eventName,data)}}}]).controller("MenuCtrl",function($scope,$rootScope){$scope.toggle_menu=function(){$rootScope.isToggleMenu=!$rootScope.isToggleMenu},$scope.toggle_chat=function(){$rootScope.isChat=!$rootScope.isChat}}).controller("ChatCtrl",function($scope,$rootScope,socket,$cookies){$scope.close_chat=function(){console.log("Close Chat"),$rootScope.isChat=!1},$scope.send_text=function(){socket.emit("send-text",$cookies.get("username")+": "+$scope.chat.text),$scope.chat.text=""},socket.on("broadcast-text",function(data){console.log("Incomming message: "+data),old_msg=document.getElementById("msg_box").innerHTML,document.getElementById("msg_box").innerHTML=old_msg+"<p>"+data.message+"</p>"})}),console.log("CHAT"),angular.module("appNote",["ngRoute","ngCookies"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/note",{resolve:{check:function($cookies,$location){$cookies.get("token")||(window.location.href="/login")}},controller:"noteController",templateUrl:"/templates/note.html"})}]).controller("noteController",function($scope,$rootScope,$location,$http,$cookies){function load_notes(){$rootScope.isLoading=!0;var userid=$cookies.get("userid");$http.get("/api/note/"+userid).success(function(response){response.success?$scope.notes=response.data:$scope.error=response.message,$rootScope.isLoading=!1})}$scope.init=function(){$rootScope.isToggleMenu=!1,console.log("Note Initializing..."),$scope.note={text:"",uid:""},$scope.error="",$scope.flash="",load_notes()},$scope.init(),$scope.create_note=function(){$rootScope.isLoading=!0,$scope.note.uid=$cookies.get("userid"),$http.post("/api/note",$scope.note).success(function(response){console.log(response),response.success?($scope.flash=response.message,$scope.error="",load_notes(),$scope.note.text="",$scope.note.uid=""):($scope.error=response.message,$scope.flash=""),$rootScope.isLoading=!1})}}),angular.module("appProduct",["ngRoute","ngCookies","ngAnimate","ui.bootstrap"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/product",{resolve:{check:function($cookies,$location){$cookies.get("token")||(window.location.href="/login")}},controller:"productController",templateUrl:"/templates/product.html"})}]).controller("productController",function($scope,$location,$http,$cookies,$uibModal,$rootScope){function load_products(){$rootScope.isLoading=!0,$http.get("/api/product").success(function(response){response.success?$scope.products=response.data:$scope.error=response.message,$rootScope.isLoading=!1})}$scope.init=function(){$rootScope.isToggleMenu=!1,console.log("Produt Initializing..."),$scope.error="",$scope.flash="",load_products()},$scope.init(),$scope.create_product=function(){$rootScope.isLoading=!0,$http.post("/api/product",$scope.product).success(function(response){console.log(response),response.success?($scope.flash=response.message,$scope.error="",load_products(),$scope.product.name="",$scope.product.code="",$scope.product.price=""):($scope.error=response.message,$scope.flash=""),$rootScope.isLoading=!1})},$scope.delete_product=function(id){$rootScope.isLoading=!0,$http["delete"]("/api/product/"+id).success(function(response){console.log(response),response.success?($scope.flash=response.message,$scope.error="",load_products()):($scope.error=response.message,$scope.flash=""),$rootScope.isLoading=!1})},$scope.open_edit_modal=function(id){var modalInstance=$uibModal.open({animation:!0,templateUrl:"/templates/edit-product.html",controller:"editProductController",size:"md",resolve:{id:function(){return id}}});modalInstance.result.then(function(){console.log("Edit Successful"),$scope.flash="Edit Successful",load_products()},function(){console.log("Modal Closed")})}}).controller("editProductController",function($scope,$http,$uibModalInstance,id,$rootScope){function load_product(get_id){$rootScope.isLoading=!0,$http.get("/api/product/"+get_id).success(function(response){response.success?(console.log(response.data),$scope.product=response.data):$scope.error=response.message,$rootScope.isLoading=!1})}$scope.init=function(){console.log("Edit Product Initializing..."),load_product(id),$scope.error=""},$scope.init(),$scope.cancel=function(){$uibModalInstance.dismiss("cancel")},$scope.edit_product=function(){$rootScope.isLoading=!0;var body={name:$scope.product.name,code:$scope.product.code,price:$scope.product.price};$http.put("/api/product/"+id,body).success(function(response){response.success?(console.log(response.message),$scope.error=null,$uibModalInstance.close(response.message)):$scope.error=response.message,$rootScope.isLoading=!1})}}),angular.module("appUser",["ngRoute","ngCookies"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/user",{resolve:{check:function($cookies,$location){$cookies.get("token")||(window.location.href="/login")}},controller:"userController",templateUrl:"/templates/user.html"})}]).controller("userController",function($scope,$rootScope,$location,$http){function load_users(){$rootScope.isLoading=!0,$http.get("/api/user").success(function(response){response.success?$scope.users=response.data:$scope.error=response.message,$rootScope.isLoading=!1})}$scope.init=function(){$rootScope.isToggleMenu=!1,console.log("User Initializing..."),$scope.error="",$scope.flash="",load_users()},$scope.init(),$scope.create_user=function(){$rootScope.isLoading=!0,$http.post("/api/user",$scope.user).success(function(response){console.log(response),response.success?($scope.flash=response.message,$scope.error="",load_users(),$scope.user.username="",$scope.user.password=""):($scope.error=response.message,$scope.flash=""),$rootScope.isLoading=!1})}});